(()=>{"use strict";var e={6031:(e,t,n)=>{var o=n(5043),i=n(4391),r=n(1527),s=n(3248),a=n(8903),l=n(5865),d=n(547),c=n(794),u=n(1906),v=n(6658),h=n(3216);const m=n(6213).A.create({baseURL:"https://hidralpress.ngrok.app",withCredentials:!1,headers:{"Content-Type":"multipart/form-data","ngrok-skip-browser-warning":!0}});var p=n(6446),g=n(1637),x=n(579);const f=function(){return(0,x.jsx)(p.A,{display:"flex",m:2,justifyContent:"center",children:(0,x.jsx)(g.A,{})})};var j=n(9336);const y=function(){return(0,x.jsxs)(p.A,{sx:{textAlign:"center",position:"fixed",bottom:0,width:"100%"},children:[(0,x.jsx)(j.A,{variant:"middle"}),(0,x.jsx)(l.A,{variant:"caption",children:"Boa sess\xe3o de fotos!"})]})},b={border:"none",width:"20%",textAlign:"center",outline:"none",fontSize:"20px"};const A=function(){const[e,t]=(0,o.useState)(null),[n,i]=(0,o.useState)(null),[r,s]=(0,o.useState)(null),[p,g]=(0,o.useState)(!1),[j,A]=(0,o.useState)(!1),w=(0,h.Zp)(),S=(0,h.zy)();return(0,o.useEffect)((()=>{var e;"ok"===(null===S||void 0===S||null===(e=S.state)||void 0===e?void 0:e.status)&&A(!0)}),[]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(a.Ay,{container:!0,sx:{mt:8,p:4},children:[(0,x.jsx)(a.Ay,{item:!0,xs:12,children:(0,x.jsx)(l.A,{align:"center",variant:"h5",fontWeight:900,children:"Preencha o campo com o n\xfamero da ordem de servi\xe7o:"})}),(0,x.jsxs)(a.Ay,{container:!0,item:!0,xs:12,sx:{display:"flex",flexDirection:"column",borderRadius:"4pt",padding:"16pt",textAlign:"left",width:"100%",mt:8},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"center",border:"3px solid #003366",borderRadius:"4px",padding:"6px"},children:[(0,x.jsx)(l.A,{children:"OS "}),(0,x.jsx)("input",{value:e,maxLength:3,autoFocus:!0,style:b,id:"input-1",inputmode:"numeric",onChange:e=>{const{target:{value:n}}=e;t(n),3===(null===n||void 0===n?void 0:n.length)&&document.getElementById("input-2").focus()}}),(0,x.jsx)(l.A,{children:"-"}),(0,x.jsx)("input",{required:!0,maxLength:2,id:"input-2",value:n,inputmode:"numeric",style:b,onChange:e=>i(e.target.value)})]}),!!r&&(0,x.jsx)(d.A,{severity:"error",sx:{mt:1},children:r}),j&&(0,x.jsx)(c.A,{open:j,autoHideDuration:5e3,onClose:(e,t)=>{"clickaway"!==t&&A(!1)},anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,x.jsx)(d.A,{severity:"success",sx:{mt:1},onClose:()=>A(""),children:"Fotos enviadas com sucesso!"})}),p?(0,x.jsx)(f,{}):(0,x.jsx)(u.A,{variant:"contained",size:"large",endIcon:(0,x.jsx)(v.A,{}),fullWidth:!0,onClick:async()=>{const t=`OS ${e}-${n}`,o=new FormData;o.append("os",t),g(!0);try{var i;const e=await m.post("/validate-os/",o);g(!1),null!==e&&void 0!==e&&null!==(i=e.data)&&void 0!==i&&i.ok?w(`/os/${t}/setor`):s(`Pasta '${t}' n\xe3o encontrada.`)}catch(r){console.log(r),g(!1),s("N\xe3o foi poss\xedvel realizar esta opera\xe7\xe3o. Verifique se o sistema est\xe1 no ar.")}},sx:{mt:3},disabled:!(3===(null===e||void 0===e?void 0:e.length)&&2===(null===n||void 0===n?void 0:n.length)),children:"Escolher setor"})]})]}),(0,x.jsx)(y,{})]})};var w=n(3193),S=n(9190),k=n(2339),C=n(7970),E=n(7392),O=n(9120),I=n(1896),T=n(5382);const z=function(){const[e,t]=(0,o.useState)(null),[n,i]=(0,o.useState)(null);(0,o.useEffect)((()=>{(async()=>{const e=await m.get("/sectors");200===(null===e||void 0===e?void 0:e.status)&&t(null===e||void 0===e?void 0:e.data);const n=await m.get("/steps");200===(null===n||void 0===n?void 0:n.status)&&i(null===n||void 0===n?void 0:n.data)})()}),[]);const r={montagem:null===n||void 0===n?void 0:n.filter((e=>{var t;return"montagem"===(null===e||void 0===e||null===(t=e.sector)||void 0===t?void 0:t.name)})),desmontagem:null===n||void 0===n?void 0:n.filter((e=>{var t;return"desmontagem"===(null===e||void 0===e||null===(t=e.sector)||void 0===t?void 0:t.name)}))};return{sectors:e,steps:n,stepsMapping:r}};var L=n(3471);const F=e=>{let{images:t,selectedImage:n,setSelectedImage:o,isLoadingImgs:i}=e;return(0,x.jsxs)(p.A,{sx:{width:"90svw",margin:"0 auto",textAlign:"center"},children:[(0,x.jsx)(p.A,{sx:{padding:2},children:null!==n&&void 0!==n&&n.thumbnail?(0,x.jsx)("img",{src:null===n||void 0===n?void 0:n.thumbnail,alt:`Selecionada imagem: ${null===n||void 0===n?void 0:n.id}`,style:{width:"100%",maxHeight:"450px",objectFit:"contain",borderRadius:"8px"},loading:"lazy"}):(0,x.jsx)(l.A,{variant:"h6",color:"text.secondary",children:"Nenhuma imagem selecionada"})}),(0,x.jsx)(p.A,{sx:{display:"flex",overflowX:"auto",gap:2,padding:1,"&::-webkit-scrollbar":{display:"none"}},children:i?(0,x.jsx)(f,{}):null===t||void 0===t?void 0:t.map(((e,t)=>(0,x.jsx)(p.A,{onClick:()=>o(e),sx:{flex:"0 0 auto",width:100,height:100,p:1,cursor:"pointer",borderRadius:"8px",overflow:"hidden",border:(null===n||void 0===n?void 0:n.thumbnail)===(null===e||void 0===e?void 0:e.thumbnail)?"3px solid #003366":"none",boxShadow:(null===n||void 0===n?void 0:n.thumbnail)===(null===e||void 0===e?void 0:e.thumbnail)?"0 0 10px rgba(0, 51, 102, 0.7)":"none",transition:"transform 0.2s, border 0.2s","&:hover":{transform:"scale(1.05)"},position:"relative"},children:(0,x.jsx)("img",{src:null===e||void 0===e?void 0:e.thumbnail,style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:"100%",minHeight:"100%",objectFit:"cover"},alt:`Imagem ${t+1}`,loading:"lazy"},null===e||void 0===e?void 0:e.id)},null===e||void 0===e?void 0:e.thumbnail))).reverse()})]})};var P=n(7097);const M=()=>{const e=(0,s.jE)(),[t,n]=(0,o.useState)(null),[i,r]=(0,o.useState)(!1),{mutate:a}=(0,P.n)({mutationFn:async e=>(await m.post("/os/",e)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["images"]}),r(!1)},onError:e=>{r(!1),n("Erro ao enviar a foto. Tente novamente e se persistir, entre em contato com o Administrador.")}});return{handleSubmit:a,loading:i,setLoading:r,error:t}};var N=n(3747);const W=e=>{let{step:t,os:n}=e;const[i,r]=(0,o.useState)(null),[a,l]=(0,o.useState)(!1);console.log(t,n);const d=(0,s.jE)(),{data:c,isError:u,isLoading:v}=(0,N.I)({queryKey:["images",t,n],queryFn:()=>(async(e,t)=>{if(e&&t){const{data:n}=await m.get("/images",{params:{step:e,os:t}});return n}})(t.toUpperCase(),n)});console.log(c);const{mutate:h,isLoading:p}=(0,P.n)({mutationFn:async e=>(await m.delete(`/images/${e}`)).data,onSuccess:()=>{d.invalidateQueries({queryKey:["images"]}),l(!1)},onError:e=>{l(!1),r("Erro ao deletar a foto. Tente novamente e se persistir, entre em contato com o Administrador.")}});return{images:c,isError:u,isLoading:a,setIsLoading:l,error:i,deleteImage:h,isDeleting:p,isLoadingImgs:v}};n(6312);const q={desmontagem:{"C-EQUIPAMENTO":"CHEGADA","E-DESMONTADO":"DESMONTADO","E-PRONTO":"PRONTO"},montagem:{"E-MONTAGEM":"MONTAGEM","E-TESTE":"TESTE"}};const D=function(){var e;const[t,n]=(0,o.useState)(""),[i,r]=(0,o.useState)(null),{handleSubmit:s,loading:a,setLoading:c,error:v}=M(),m=(0,h.zy)(),{stepsMapping:g}=z(),j=null===m||void 0===m?void 0:m.pathname,y=null===m||void 0===m?void 0:m.state,{images:b,deleteImage:A,isLoading:P,setIsLoading:N,isLoadingImgs:D}=W({step:t,os:null===y||void 0===y?void 0:y.os});console.log(b);const R=(0,o.useRef)(null),_=(0,h.Zp)(),$=(0,o.useMemo)((()=>{var e;return null===(e=unescape(j))||void 0===e?void 0:e.split("/")}),[j]),B=(0,o.useMemo)((()=>!(null===b||void 0===b||!b.length)),[b]),H=(0,o.useRef)(Promise.resolve()),U=async e=>{const n=new FormData;n.append("os",$[2]),n.append("sector",$[4]),n.append("step",t),n.append("image",e),c(!0),s(n)};return(0,x.jsxs)(p.A,{p:2,display:"flex",flexDirection:"column",height:"100svh",alignItems:"center",justifyContent:"space-between",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)(l.A,{variant:"h6",fontWeight:700,mb:1,children:"Selecione a etapa que est\xe1 fotografando:"}),(0,x.jsxs)(w.A,{fullWidth:!0,sx:{mb:3},children:[(0,x.jsx)(S.A,{id:"etapa-select",children:"Etapa"}),(0,x.jsx)(k.A,{labelId:"etapa-select",id:"etapa-select",value:t,label:"Etapa",onChange:e=>n(e.target.value),placeholder:"Escolha a etapa",sx:{color:"black"},children:null===(e=g[$[4]])||void 0===e?void 0:e.map((e=>(0,x.jsx)(C.A,{sx:{color:"black"},value:null===e||void 0===e?void 0:e.name,children:q[$[4]][null===e||void 0===e?void 0:e.name]},null===e||void 0===e?void 0:e.id)))})]})]}),(0,x.jsxs)(p.A,{sx:{borderRadius:1,p:1,boxShadow:B?"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)":null,mb:2},children:[(0,x.jsxs)(p.A,{sx:{display:"flex",justifyContent:B?"space-between":"center",p:1,alignItems:"center"},children:[a?(0,x.jsx)(f,{}):(0,x.jsx)(u.A,{disabled:t.length<1,variant:"contained",size:"large",startIcon:(0,x.jsx)(I.A,{}),fullWidth:!B,onClick:()=>R.current.click(),children:"Bater foto"}),(0,x.jsx)("input",{type:"file",accept:"image/*",capture:"environment",onChange:async e=>{const t=e.target.files[0];if(t)try{H.current=await H.current,await U(t)}catch(e){console.error("Image error: ",e)}finally{e.target.value=null}},ref:R,style:{display:"none"}}),B&&(P?(0,x.jsx)(f,{}):(0,x.jsx)(E.A,{size:"large",children:(0,x.jsx)(L.A,{color:"primary",onClick:()=>{N(!0),A(null===i||void 0===i?void 0:i.id),r(null)}})}))]}),B&&t&&(0,x.jsx)(F,{images:b,selectedImage:i,setSelectedImage:r,isLoadingImgs:D})]}),v&&(0,x.jsx)(d.A,{severity:"error",children:v}),(0,x.jsxs)(p.A,{sx:{display:"flex",justifyContent:"space-between",width:"100%",m:2},children:[(0,x.jsx)(u.A,{variant:"outlined",startIcon:(0,x.jsx)(O.A,{}),onClick:()=>{_(-1)},children:"Voltar"}),(0,x.jsx)(u.A,{endIcon:(0,x.jsx)(T.A,{}),disabled:(null===b||void 0===b?void 0:b.length)<1,variant:"contained",onClick:()=>{_("/os",{state:{status:"ok"}})},children:"Finalizar"})]})]})};var R=n(2645),_=n(3397);const $=function(){var e;const t=(0,h.Zp)(),n=(0,h.zy)(),{sectors:o}=z(),i=unescape(null===n||void 0===n||null===(e=n.pathname)||void 0===e?void 0:e.split("/")[2]),r={montagem:{icon:(0,x.jsx)(R.A,{}),color:"secondary"},desmontagem:{icon:(0,x.jsx)(_.A,{}),color:"primary"}};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(a.Ay,{container:!0,px:4,pt:2,children:[(0,x.jsx)(a.Ay,{item:!0,xs:2,children:(0,x.jsx)(u.A,{startIcon:(0,x.jsx)(O.A,{}),size:"large",onClick:()=>{t("/os")}})}),(0,x.jsx)(a.Ay,{item:!0,xs:8,display:"flex",alignItems:"center",justifyContent:"center",children:(0,x.jsx)(l.A,{variant:"h5",children:i})}),(0,x.jsx)(a.Ay,{item:!0,xs:2})]}),(0,x.jsxs)(a.Ay,{container:!0,sx:{px:4,height:"70%"},direction:"column",display:"flex",justifyContent:"center",children:[(0,x.jsx)(l.A,{variant:"overline",children:"Selecione o setor:"}),!(null===o||void 0===o||!o.length)&&(null===o||void 0===o?void 0:o.map((e=>{var n,o;return(0,x.jsxs)("div",{children:[(0,x.jsx)(u.A,{fullWidth:!0,size:"large",startIcon:null===(n=r[null===e||void 0===e?void 0:e.name])||void 0===n?void 0:n.icon,color:null===(o=r[null===e||void 0===e?void 0:e.name])||void 0===o?void 0:o.color,variant:"contained",onClick:()=>(e=>{t(`${e}/camera`,{state:{os:i}})})(null===e||void 0===e?void 0:e.name),sx:{padding:4,fontSize:"24px"},children:null===e||void 0===e?void 0:e.name}),(0,x.jsx)(j.A,{sx:{my:2}})]},null===e||void 0===e?void 0:e.id)})))]})]})};const B=function(){return(0,x.jsx)("div",{style:{backgroundColor:"#757575",width:"100%"},children:(0,x.jsx)("img",{src:"/logo-hidralpress.png",style:{backgroundColor:"#757575",width:"100%"},alt:"Logo Hidralpress"})})};const H=function(){return(0,x.jsxs)("div",{style:{height:"100vh"},children:[(0,x.jsx)(B,{}),(0,x.jsx)(h.sv,{})]})};var U=n(5475);const K=function(){return(0,x.jsx)(U.Kd,{children:(0,x.jsxs)(h.BV,{children:[(0,x.jsxs)(h.qh,{path:"/",element:(0,x.jsx)(H,{}),children:[(0,x.jsx)(h.qh,{index:!0,element:(0,x.jsx)(h.C5,{to:"/os"})}),(0,x.jsx)(h.qh,{path:"/os",element:(0,x.jsx)(A,{})}),(0,x.jsx)(h.qh,{path:"/os/:os/setor",element:(0,x.jsx)($,{})})]}),(0,x.jsx)(h.qh,{path:"/os/:os/setor/:setor/camera",element:(0,x.jsx)(D,{})})]})})},G=new r.E;const Q=function(){return(0,x.jsx)(s.Ht,{client:G,children:(0,x.jsx)(K,{})})},V=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,6453)).then((t=>{let{getCLS:n,getFID:o,getFCP:i,getLCP:r,getTTFB:s}=t;n(e),o(e),i(e),r(e),s(e)}))};var Z=n(5969);const X=(0,n(8279).A)({typography:{fontSize:18,h1:{fontSize:"3rem"},h2:{fontSize:"2.5rem"},h3:{fontSize:"2rem"},body1:{fontSize:"1.5rem"},body2:{fontSize:"1.25rem"},button:{fontSize:"1.5rem"}},palette:{background:{default:"#C4C1C1"},primary:{main:"#003366"},secondary:{main:"#03A9F4"},success:{main:"#4CAF50"},camera:{main:"#ffffff"},text:{primary:"#757575",secondary:"#424242"}}}),J=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Y(e,t){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const n=e.installing;null!=n&&(n.onstatechange=()=>{"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}i.createRoot(document.getElementById("root")).render((0,x.jsx)(o.StrictMode,{children:(0,x.jsx)(Z.A,{theme:X,children:(0,x.jsx)(Q,{})})})),V(),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t="/service-worker.js";J?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((n=>{const o=n.headers.get("content-type");404===n.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):Y(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Y(t,e)}))}}()}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.m=e,(()=>{var e=[];n.O=(t,o,i,r)=>{if(!o){var s=1/0;for(c=0;c<e.length;c++){o=e[c][0],i=e[c][1],r=e[c][2];for(var a=!0,l=0;l<o.length;l++)(!1&r||s>=r)&&Object.keys(n.O).every((e=>n.O[e](o[l])))?o.splice(l--,1):(a=!1,r<s&&(s=r));if(a){e.splice(c--,1);var d=i();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[o,i,r]}})(),n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(o,i){if(1&i&&(o=this(o)),8&i)return o;if("object"===typeof o&&o){if(4&i&&o.__esModule)return o;if(16&i&&"function"===typeof o.then)return o}var r=Object.create(null);n.r(r);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&o;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>s[e]=()=>o[e]));return s.default=()=>o,n.d(r,s),r}})(),n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,o)=>(n.f[o](e,t),t)),[])),n.u=e=>"static/js/"+e+".93e77268.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="hidralpress-frontend:";n.l=(o,i,r,s)=>{if(e[o])e[o].push(i);else{var a,l;if(void 0!==r)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==o||u.getAttribute("data-webpack")==t+r){a=u;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+r),a.src=o),e[o]=[i];var v=(t,n)=>{a.onerror=a.onload=null,clearTimeout(h);var i=e[o];if(delete e[o],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},h=setTimeout(v.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=v.bind(null,a.onerror),a.onload=v.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,o)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)o.push(i[2]);else{var r=new Promise(((n,o)=>i=e[t]=[n,o]));o.push(i[2]=r);var s=n.p+n.u(t),a=new Error;n.l(s,(o=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var r=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,i[1](a)}}),"chunk-"+t,t)}},n.O.j=t=>0===e[t];var t=(t,o)=>{var i,r,s=o[0],a=o[1],l=o[2],d=0;if(s.some((t=>0!==e[t]))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)var c=l(n)}for(t&&t(o);d<s.length;d++)r=s[d],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(c)},o=self.webpackChunkhidralpress_frontend=self.webpackChunkhidralpress_frontend||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=n.O(void 0,[856],(()=>n(6031)));o=n.O(o)})();
//# sourceMappingURL=main.3026140f.js.map